import{t as b,a as v,c as be,d as _e}from"../chunks/B844KiKP.js";import"../chunks/DKOGnCGE.js";import{ae as je,ap as A,aq as D,ag as ye,au as xe,ar as s,b as K,c as e,r as t,f as r,x as B,aw as ke,l as u}from"../chunks/BXsRLg6A.js";import{s as l}from"../chunks/-CDTaoNk.js";import{i as C}from"../chunks/dTEDWTZQ.js";import{e as Ie,i as $e}from"../chunks/FxtfLCaA.js";import{h as Le}from"../chunks/BuC1pS7D.js";import{s as Q}from"../chunks/8eJ-M5eg.js";import{e as V}from"../chunks/JJDN1UTm.js";import{i as Ue}from"../chunks/DFYwXNvY.js";import{o as Me}from"../chunks/B7JBmkl3.js";import{b as d}from"../chunks/BuKi2LIm.js";import{g as p}from"../chunks/BRtzJ_cC.js";import{P as Pe}from"../chunks/XVZJVHkn.js";const Se=!1,We=Object.freeze(Object.defineProperty({__proto__:null,prerender:Se},Symbol.toStringTag,{value:"Module"}));var Ae=be('<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"><\/script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"><\/script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"><\/script> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link href="https://fonts.googleapis.com/css?family=Mulish" rel="stylesheet"> <link href="https://fonts.googleapis.com/css?family=Inter" rel="stylesheet"> <link rel="stylesheet">',1),De=b('<tr class="svelte-1jdwbw6"><td class="svelte-1jdwbw6">Loading users</td></tr>'),Be=b('<tr class="svelte-1jdwbw6"><td class="svelte-1jdwbw6"> </td></tr>'),Ce=b('<tr class="svelte-1jdwbw6"><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td></tr>'),Ee=b('<header><div class="header-container"><div class="top-header"><a class="top-header-link" href="https://berrys.com">berrys.com</a></div> <div class="header"><button class="header-btn svelte-1jdwbw6">Dashboard</button> <button class="header-btn svelte-1jdwbw6">Logout</button></div></div></header> <div class="main-container svelte-1jdwbw6"><div class="dashboard-header svelte-1jdwbw6"><h1 class="svelte-1jdwbw6">Manage users</h1> <div class="date-time"> </div></div> <div class="data-container"><table class="desktop-view svelte-1jdwbw6"><thead class="svelte-1jdwbw6"><tr class="svelte-1jdwbw6"><th class="svelte-1jdwbw6">User ID</th><th class="svelte-1jdwbw6">Full Name</th><th class="svelte-1jdwbw6">Company Name</th><th class="svelte-1jdwbw6">Email</th><th class="svelte-1jdwbw6">Phone Number</th><th class="svelte-1jdwbw6">Is Admin</th><th class="svelte-1jdwbw6">Last Login</th></tr></thead><tbody class="svelte-1jdwbw6"><!></tbody></table></div></div> <footer><div style="display: flex; justify-content: space-between; align-items: center; padding: 0 20px;"><span style="font-size: 1rem; font-family: Mulish;">@copyrights Berrys Global Innovations</span> <img alt="Berrys Logo"></div></footer>',1);function Xe(W,X){je(X,!1);let f=B([]),w=B(null),_=B(!0);function Z(a){return new Date(a).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\//g,"-")}async function ee(){localStorage.removeItem("jwt_token"),localStorage.removeItem("is_admin"),await p(`${d}/login?authMessage=${encodeURIComponent("You have been logged out.")}`)}async function te(){u(_,!0),u(w,null);const a=localStorage.getItem("jwt_token"),i=localStorage.getItem("is_admin")==="true";if(!a||!i){await p(`${d}/login?authMessage=${encodeURIComponent("Access Denied. Please log in as an administrator.")}`);return}try{const o=await fetch(`${Pe}/api/admin/users`,{headers:{Authorization:`Bearer ${a}`}});if(!o.ok)if(o.status===401){await p(`${d}/login?authMessage=${encodeURIComponent("Your session has expired. Please log in again.")}`);return}else if(o.status===403){await p(`${d}/login?authMessage=${encodeURIComponent("Access Denied. You do not have administrator privileges.")}`);return}else{const k=await o.json().catch(()=>({message:"Unknown error occurred."}));throw new Error(k.error||`HTTP Error: ${o.status}`)}u(f,await o.json()),console.log("Admin users loaded:",r(f))}catch(o){console.error("Error fetching admin users:",o),u(w,o.message||"Failed to load users. Please try again.")}finally{u(_,!1)}}Me(async()=>{await te()}),Ue();var E=Ee();Le(a=>{var i=Ae();xe.title="Manage Users";var o=s(A(i),14);Q(o,"href",`${d??""}/css/styles.css`),v(a,i)});var j=A(E),R=e(j),T=s(e(R),2),N=e(T),ae=ke(()=>p(`${d}/admin`)),se=s(N,2);t(T),t(R),t(j);var y=s(j,2),x=e(y),Y=s(e(x),2),re=e(Y,!0);t(Y),t(x);var z=s(x,2),F=e(z),q=s(e(F)),oe=e(q);{var ie=a=>{var i=De();v(a,i)},le=(a,i)=>{{var o=c=>{var m=Be(),g=e(m),h=e(g,!0);t(g),t(m),D(()=>l(h,r(w))),v(c,m)},k=(c,m)=>{{var g=h=>{var H=_e(),de=A(H);Ie(de,1,()=>r(f),$e,(ce,n)=>{var I=Ce(),$=e(I),ve=e($,!0);t($);var L=s($),me=e(L);t(L);var U=s(L),he=e(U,!0);t(U);var M=s(U),ue=e(M,!0);t(M);var P=s(M),pe=e(P,!0);t(P);var S=s(P),fe=e(S,!0);t(S);var J=s(S),we=e(J,!0);t(J),t(I),D(ge=>{l(ve,r(n).user_id),l(me,`${r(n).first_name??""} ${r(n).last_name??""}`),l(he,r(n).company_name),l(ue,r(n).email),l(pe,r(n).phone_number),l(fe,r(n).is_admin?"Yes":"No"),l(we,ge)},[()=>Z(r(n).last_login)],K),v(ce,I)}),v(h,H)};C(c,h=>{r(f).length>0&&h(g)},m)}};C(a,c=>{r(w)?c(o):c(k,!1)},i)}};C(oe,a=>{r(_)?a(ie):a(le,!1)})}t(q),t(F),t(z),t(y);var G=s(y,2),O=e(G),ne=s(e(O),2);Q(ne,"src",`${d??""}/images/logo.png`),t(O),t(G),D(a=>l(re,a),[()=>new Date().toLocaleString()],K),V("click",N,function(...a){var i;(i=r(ae))==null||i.apply(this,a)}),V("click",se,ee),v(W,E),ye()}export{Xe as component,We as universal};

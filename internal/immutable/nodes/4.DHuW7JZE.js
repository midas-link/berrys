import{t as g,a as c,c as be,d as ge}from"../chunks/B844KiKP.js";import"../chunks/DKOGnCGE.js";import{ae as _e,ap as D,aq as S,ag as je,au as ye,ar as a,b as K,c as e,r as t,f as r,x as B,aw as xe,l as p}from"../chunks/BXsRLg6A.js";import{s as l}from"../chunks/-CDTaoNk.js";import{i as E}from"../chunks/dTEDWTZQ.js";import{e as ke,i as $e}from"../chunks/FxtfLCaA.js";import{h as Ie}from"../chunks/BuC1pS7D.js";import{s as Q}from"../chunks/8eJ-M5eg.js";import{e as V}from"../chunks/JJDN1UTm.js";import{i as Le}from"../chunks/DFYwXNvY.js";import{o as Ue}from"../chunks/B7JBmkl3.js";import{b as v}from"../chunks/D5GL2ITj.js";import{g as b}from"../chunks/DRWyyep2.js";import{P as Me}from"../chunks/XVZJVHkn.js";const Pe=!1,Ve=Object.freeze(Object.defineProperty({__proto__:null,prerender:Pe},Symbol.toStringTag,{value:"Module"}));var Ae=be('<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"><\/script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"><\/script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"><\/script> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link href="https://fonts.googleapis.com/css?family=Mulish" rel="stylesheet"> <link href="https://fonts.googleapis.com/css?family=Inter" rel="stylesheet"> <link rel="stylesheet">',1),De=g('<tr class="svelte-1jdwbw6"><td class="svelte-1jdwbw6">Loading users</td></tr>'),Se=g('<tr class="svelte-1jdwbw6"><td class="svelte-1jdwbw6"> </td></tr>'),Be=g('<tr class="svelte-1jdwbw6"><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td><td class="svelte-1jdwbw6"> </td></tr>'),Ee=g('<header><div class="header-container"><div class="top-header"><a class="top-header-link" href="https://berrys.com">berrys.com</a></div> <div class="header"><button class="header-btn svelte-1jdwbw6">Dashboard</button> <button class="header-btn svelte-1jdwbw6">Logout</button></div></div></header> <div class="main-container svelte-1jdwbw6"><div class="dashboard-header svelte-1jdwbw6"><h1 class="svelte-1jdwbw6">Manage users</h1> <div class="date-time"> </div></div> <div class="data-container"><table class="desktop-view svelte-1jdwbw6"><thead class="svelte-1jdwbw6"><tr class="svelte-1jdwbw6"><th class="svelte-1jdwbw6">User ID</th><th class="svelte-1jdwbw6">Full Name</th><th class="svelte-1jdwbw6">Company Name</th><th class="svelte-1jdwbw6">Email</th><th class="svelte-1jdwbw6">Phone Number</th><th class="svelte-1jdwbw6">Is Admin</th><th class="svelte-1jdwbw6">Last Login</th></tr></thead><tbody class="svelte-1jdwbw6"><!></tbody></table></div></div> <footer><div style="display: flex; justify-content: space-between; align-items: center; padding: 0 20px;"><span style="font-size: 1rem; font-family: Mulish;">@copyrights Berrys Global Innovations</span> <img alt="Berrys Logo"></div></footer>',1);function We(W,X){_e(X,!1);let u=B([]),f=B(null),_=B(!0);function Z(s){return new Date(s).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\//g,"-")}async function ee(){p(_,!0),p(f,null);const s=localStorage.getItem("jwt_token"),i=localStorage.getItem("is_admin")==="true";if(!s||!i){await b(`${v}/login?authMessage=${encodeURIComponent("Access Denied. Please log in as an administrator.")}`);return}try{const o=await fetch(`${Me}/api/admin/users`,{headers:{Authorization:`Bearer ${s}`}});if(!o.ok)if(o.status===401){await b(`${v}/login?authMessage=${encodeURIComponent("Your session has expired. Please log in again.")}`);return}else if(o.status===403){await b(`${v}/login?authMessage=${encodeURIComponent("Access Denied. You do not have administrator privileges.")}`);return}else{const k=await o.json().catch(()=>({message:"Unknown error occurred."}));throw new Error(k.error||`HTTP Error: ${o.status}`)}p(u,await o.json()),console.log("Admin users loaded:",r(u))}catch(o){console.error("Error fetching admin users:",o),p(f,o.message||"Failed to load users. Please try again.")}finally{p(_,!1)}}Ue(async()=>{await ee()}),Le();var C=Ee();Ie(s=>{var i=Ae();ye.title="Manage Users";var o=a(D(i),14);Q(o,"href",`${v??""}/css/styles.css`),c(s,i)});var j=D(C),T=e(j),N=a(e(T),2),R=e(N),te=xe(()=>b(`${v}/admin`)),se=a(R,2);t(N),t(T),t(j);var y=a(j,2),x=e(y),z=a(e(x),2),ae=e(z,!0);t(z),t(x);var F=a(x,2),Y=e(F),q=a(e(Y)),re=e(q);{var oe=s=>{var i=De();c(s,i)},ie=(s,i)=>{{var o=n=>{var m=Se(),w=e(m),h=e(w,!0);t(w),t(m),S(()=>l(h,r(f))),c(n,m)},k=(n,m)=>{{var w=h=>{var H=ge(),de=D(H);ke(de,1,()=>r(u),$e,(ne,d)=>{var $=Be(),I=e($),ce=e(I,!0);t(I);var L=a(I),ve=e(L);t(L);var U=a(L),me=e(U,!0);t(U);var M=a(U),he=e(M,!0);t(M);var P=a(M),pe=e(P,!0);t(P);var A=a(P),ue=e(A,!0);t(A);var J=a(A),fe=e(J,!0);t(J),t($),S(we=>{l(ce,r(d).user_id),l(ve,`${r(d).first_name??""} ${r(d).last_name??""}`),l(me,r(d).company_name),l(he,r(d).email),l(pe,r(d).phone_number),l(ue,r(d).is_admin?"Yes":"No"),l(fe,we)},[()=>Z(r(d).last_login)],K),c(ne,$)}),c(h,H)};E(n,h=>{r(u).length>0&&h(w)},m)}};E(s,n=>{r(f)?n(o):n(k,!1)},i)}};E(re,s=>{r(_)?s(oe):s(ie,!1)})}t(q),t(Y),t(F),t(y);var G=a(y,2),O=e(G),le=a(e(O),2);Q(le,"src",`${v??""}/images/logo.png`),t(O),t(G),S(s=>l(ae,s),[()=>new Date().toLocaleString()],K),V("click",R,function(...s){var i;(i=r(te))==null||i.apply(this,s)}),V("click",se,handleLogout),c(W,C),je()}export{We as component,Ve as universal};
